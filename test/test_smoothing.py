from nose.tools import *
import numpy as np

from smoothing import *


class test_smoothing:

    def setup(self):
        self.unsmoothed = np.array([0.83481261,  0.91539269,  0.3070502,  0.41956206,  0.57437946,
                                    0.99431607,  0.29237002,  0.33000897,  0.54932169,  0.42550596,
                                    0.91997464,  0.99996613,  0.59268089,  0.77532296,  0.55380563,
                                    0.34883845,  0.58273362,  0.19075621,  0.07894011,  0.9160215,
                                    0.9254552,  0.08965646,  0.28900834,  0.69221432,  0.4984707,
                                    0.3245672,  0.4839911,  0.21823081,  0.30459936,  0.07213628,
                                    0.65172351,  0.40677359,  0.76732565,  0.04392723,  0.44103658,
                                    0.88999209,  0.40401932,  0.51078536,  0.32593528,  0.23582174,
                                    0.95436068,  0.8984974,  0.62920882,  0.3047017,  0.8651114,
                                    0.99269907,  0.54377557,  0.18176741,  0.82856991,  0.65372575,
                                    0.18226077,  0.78681358,  0.55853879,  0.88771445,  0.3376933,
                                    0.739193,  0.67881072,  0.48594884,  0.97716248,  0.51298461,
                                    0.63516334,  0.74399739,  0.12654528,  0.64075897,  0.90520043,
                                    0.59869624,  0.49968897,  0.50704253,  0.49902518,  0.76588803,
                                    0.72961872,  0.09955773,  0.21291458,  0.12323294,  0.6943049,
                                    0.37017964,  0.7490155,  0.62299151,  0.86585444,  0.03737883,
                                    0.65924199,  0.95727644,  0.84164088,  0.51866817,  0.86301949,
                                    0.05221836,  0.48927326,  0.96040861,  0.4143911,  0.5459487,
                                    0.93935343,  0.7804046,  0.49569212,  0.05276718,  0.98385058,
                                    0.61089729,  0.83104042,  0.87320481,  0.20773095,  0.50923789])

    def test_boxcar3(self):
        expected_result_kernel3 = np.array([0.43366391,  0.43366391,  0.43366391,  0.43366391,  0.66275253,
                                            0.62035518,  0.53889836,  0.39056689,  0.43494554,  0.63160076,
                                            0.78181557,  0.83754055,  0.78932333,  0.64060316,  0.55932235,
                                            0.4951259,  0.37410943,  0.28414331,  0.39523927,  0.64013894,
                                            0.64371105,  0.43470667,  0.35695971,  0.49323112,  0.50508408,
                                            0.43567633,  0.34226303,  0.33560709,  0.19832215,  0.34281972,
                                            0.37687779,  0.60860758,  0.40600882,  0.41742982,  0.45831864,
                                            0.57834933,  0.60159892,  0.41357999,  0.35751413,  0.50537257,
                                            0.69622661,  0.82735563,  0.61080264,  0.59967397,  0.72083739,
                                            0.80052868,  0.57274735,  0.51803763,  0.55468769,  0.55485214,
                                            0.54093336,  0.50920438,  0.74435561,  0.59464885,  0.65486692,
                                            0.58523234,  0.63465085,  0.71397401,  0.65869864,  0.70843681,
                                            0.63071511,  0.501902,  0.50376721,  0.55750156,  0.71488521,
                                            0.66786188,  0.53514258,  0.50191889,  0.59065191,  0.66484397,
                                            0.53168816,  0.34736368,  0.14523508,  0.34348414,  0.39590583,
                                            0.60450002,  0.58072888,  0.74595382,  0.50874159,  0.52082509,
                                            0.55129908,  0.81938644,  0.7725285,  0.74110951,  0.47796867,
                                            0.46817037,  0.50063341,  0.62135766,  0.64024947,  0.63323108,
                                            0.75523558,  0.73848339,  0.44295463,  0.51076996,  0.54917168,
                                            0.8085961,  0.77171417,  0.63732539,  0.63732539,  0.63732539])
        np.testing.assert_almost_equal(boxcar(self.unsmoothed, 3), expected_result_kernel3)

    def test_boxcar4(self):
        expected_result_kernel4 = np.array([0.57382695,  0.57382695,  0.57382695,  0.57382695,  0.57382695,
                                            0.5701569,  0.54776863,  0.54150419,  0.39930166,  0.55620281,
                                            0.7236921,  0.7345319,  0.82198616,  0.7304439,  0.56766198,
                                            0.56517517,  0.41903348,  0.3003171,  0.44211286,  0.52779326,
                                            0.50251832,  0.55503538,  0.49908358,  0.39233746,  0.45106514,
                                            0.49981083,  0.38131495,  0.33284712,  0.26973939,  0.31167249,
                                            0.35880819,  0.47448976,  0.46743749,  0.41476576,  0.53557039,
                                            0.44474381,  0.56145834,  0.53268301,  0.36914043,  0.50672576,
                                            0.60365378,  0.67947216,  0.69669215,  0.67437983,  0.69793025,
                                            0.67657194,  0.64583836,  0.63670299,  0.55195966,  0.46158096,
                                            0.6128425,  0.54533472,  0.6038319,  0.64269003,  0.63078489,
                                            0.66085287,  0.56041147,  0.72027876,  0.66372666,  0.65281482,
                                            0.71732696,  0.50467266,  0.53661624,  0.60412552,  0.56780023,
                                            0.66108615,  0.62765704,  0.52611323,  0.56791117,  0.62539361,
                                            0.52352241,  0.45199476,  0.29133099,  0.28250254,  0.35015801,
                                            0.48418325,  0.60912289,  0.65201027,  0.56881007,  0.54636669,
                                            0.62993792,  0.62388453,  0.74420687,  0.79515125,  0.56888673,
                                            0.48079482,  0.59122993,  0.47907283,  0.60250542,  0.71502546,
                                            0.67002446,  0.69034971,  0.56705433,  0.57817862,  0.53580179,
                                            0.61963887,  0.82474828,  0.82474828,  0.82474828,  0.82474828])
        np.testing.assert_almost_equal(boxcar(self.unsmoothed, 4), expected_result_kernel4)

    def test_boxcar5(self):
        expected_result_kernel5 = np.array([0.52212732,  0.52212732,  0.52212732,  0.52212732,  0.52212732,
                                            0.52212732,  0.54807924,  0.51830454,  0.50343626,  0.64495548,
                                            0.69748986,  0.74269012,  0.76835005,  0.65412281,  0.57067631,
                                            0.49029138,  0.35101481,  0.42345798,  0.53878133,  0.4401659,
                                            0.45981632,  0.58247117,  0.49896101,  0.37878341,  0.45765033,
                                            0.44349483,  0.36597183,  0.28070495,  0.34613621,  0.33069271,
                                            0.44051168,  0.38837725,  0.46215731,  0.50981103,  0.50926018,
                                            0.45795212,  0.51435373,  0.47331076,  0.48618448,  0.58508009,
                                            0.60876478,  0.60451807,  0.730376,  0.73804368,  0.66709931,
                                            0.57761103,  0.68238467,  0.64010754,  0.47801988,  0.52662748,
                                            0.60198176,  0.61381067,  0.55060418,  0.66199063,  0.64039005,
                                            0.62587206,  0.64376167,  0.67881993,  0.658014,  0.67105133,
                                            0.59917062,  0.53188992,  0.61033308,  0.60303966,  0.55417798,
                                            0.63027743,  0.60193067,  0.57406819,  0.60025268,  0.52022644,
                                            0.46140085,  0.3862424,  0.37192577,  0.30003796,  0.42992951,
                                            0.5119449,  0.6604692,  0.52908398,  0.58689645,  0.62854864,
                                            0.67227852,  0.60284126,  0.76796939,  0.64656467,  0.55296403,
                                            0.57671758,  0.55586217,  0.49244801,  0.66987502,  0.72810129,
                                            0.63515799,  0.56283321,  0.65041358,  0.58472235,  0.59484952,
                                            0.67035206,  0.67035206,  0.67035206,  0.67035206,  0.67035206])
        np.testing.assert_almost_equal(boxcar(self.unsmoothed, 5), expected_result_kernel5)

    def test_boxcar6(self):
        expected_result_kernel6 = np.array([0.52665971,  0.52665971,  0.52665971,  0.52665971,  0.52665971,
                                            0.52665971,  0.52665971,  0.52765036,  0.58524956,  0.58619123,
                                            0.63624305,  0.71046204,  0.71120937,  0.69843145,  0.64222461,
                                            0.50735629,  0.42173283,  0.44518259,  0.50712418,  0.46392718,
                                            0.41497297,  0.49854932,  0.56847109,  0.46989537,  0.39631802,
                                            0.41774708,  0.42034558,  0.31699924,  0.34254138,  0.35624244,
                                            0.40346487,  0.37441427,  0.39715381,  0.53346311,  0.49217908,
                                            0.50951437,  0.43594931,  0.46793173,  0.55348575,  0.5549033,
                                            0.59243488,  0.5580876,  0.64795029,  0.77409651,  0.70566566,
                                            0.58621066,  0.61943751,  0.67760819,  0.56379975,  0.5294855,
                                            0.53194603,  0.64960388,  0.56779111,  0.58203565,  0.66479397,
                                            0.61464985,  0.68442047,  0.62196549,  0.67154383,  0.67234456,
                                            0.58030032,  0.60610201,  0.59410834,  0.60839361,  0.58581455,
                                            0.54632207,  0.60840205,  0.62925689,  0.59999328,  0.51680352,
                                            0.46900779,  0.40503953,  0.43758615,  0.37163475,  0.37486755,
                                            0.46210651,  0.57092982,  0.5566208,  0.55077698,  0.64862645,
                                            0.66406401,  0.64667679,  0.6462043,  0.64867755,  0.62034943,
                                            0.62087146,  0.54966317,  0.55420992,  0.56693224,  0.68829662,
                                            0.68936643,  0.53809286,  0.63300277,  0.64382753,  0.62577537,
                                            0.62577537,  0.62577537,  0.62577537,  0.62577537,  0.62577537])
        np.testing.assert_almost_equal(boxcar(self.unsmoothed, 6), expected_result_kernel6)

    def test_boxcar7(self):
        expected_result_kernel7 = np.array([0.58369669,  0.58369669,  0.58369669,  0.58369669,  0.58369669,
                                            0.58369669,  0.58369669,  0.58369669,  0.64449478,  0.58711833,
                                            0.65611161,  0.68808256,  0.65944209,  0.68190319,  0.57772913,
                                            0.44615398,  0.4923455,  0.51379296,  0.44748594,  0.43893878,
                                            0.45457888,  0.49853809,  0.53362768,  0.47190905,  0.37087699,
                                            0.40158312,  0.3706014,  0.36481699,  0.35171741,  0.41496861,
                                            0.35210235,  0.38393174,  0.46755928,  0.51497114,  0.49483712,
                                            0.48328879,  0.40735966,  0.53742158,  0.60277313,  0.56551837,
                                            0.55133014,  0.60194815,  0.69720012,  0.74119352,  0.63082305,
                                            0.62083341,  0.62433583,  0.60684427,  0.59565887,  0.53363597,
                                            0.58277009,  0.60504522,  0.59227709,  0.59586066,  0.63924467,
                                            0.66643737,  0.65992963,  0.6238509,  0.68189434,  0.59437324,
                                            0.58893727,  0.64883036,  0.59476375,  0.59286437,  0.5745614,
                                            0.53956537,  0.63090005,  0.6435943,  0.52850248,  0.47339082,
                                            0.41961139,  0.44636315,  0.42795665,  0.42554629,  0.41031383,
                                            0.51978479,  0.49470825,  0.57128097,  0.60884834,  0.67619994,
                                            0.64329318,  0.67758289,  0.56134916,  0.62590551,  0.66892932,
                                            0.59137427,  0.54913253,  0.60923042,  0.5974283,  0.66078169,
                                            0.59842368,  0.60177253,  0.62984484,  0.67057223,  0.67057223,
                                            0.67057223,  0.67057223,  0.67057223,  0.67057223,  0.67057223])
        np.testing.assert_almost_equal(boxcar(self.unsmoothed, 7), expected_result_kernel7)
